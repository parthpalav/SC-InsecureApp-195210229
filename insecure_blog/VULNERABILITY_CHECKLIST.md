# üîç Vulnerability Testing Checklist

Use this checklist to systematically test all vulnerabilities in the Insecure Blog application.

## ‚úÖ Pre-Setup Checklist

- [ ] XAMPP installed and running
- [ ] Apache service started
- [ ] MySQL service started
- [ ] Database created using `database_setup.sql`
- [ ] Application accessible at `http://localhost/insecure_blog/`
- [ ] Test accounts verified (can login with admin@test.com / admin123)

---

## üéØ Vulnerability Testing

### 1. SQL Injection (Login Page)

**File**: `login.php` (Lines 23-25)

**Test Steps**:
- [ ] Navigate to login page
- [ ] Enter in Email field: `' OR '1'='1`
- [ ] Enter in Password field: `' OR '1'='1`
- [ ] Click Login
- [ ] **Expected**: Successfully logged in without valid credentials
- [ ] **Screenshot**: Login bypass

**Code Location**:
```php
$query = "SELECT * FROM users WHERE email='$email' AND password='$password'";
```

**Impact**: Complete authentication bypass, unauthorized access

---

### 2. Stored XSS (Blog Posts)

**Files**: `create_post.php`, `view_post.php`

**Test Steps**:
- [ ] Login with any valid account
- [ ] Navigate to "Create New Post"
- [ ] In Title field, enter: `<script>alert('XSS in Title')</script>`
- [ ] In Content field, enter: `<script>alert('XSS in Content')</script>`
- [ ] Submit the post
- [ ] Click to view the post
- [ ] **Expected**: JavaScript alert boxes execute
- [ ] **Screenshot**: XSS alert firing

**Code Location** (view_post.php):
```php
echo $post['title'];  // Line 44
echo $post['content']; // Line 52
```

**Impact**: Session hijacking, cookie theft, malicious redirects

---

### 3. Reflected XSS (Profile Page)

**File**: `profile.php` (Line 53)

**Test Steps**:
- [ ] Login with any account
- [ ] Visit URL: `profile.php?id=<script>alert('Reflected XSS')</script>`
- [ ] **Expected**: JavaScript alert executes immediately
- [ ] Try also: `profile.php?id=<img src=x onerror=alert('XSS')>`
- [ ] **Screenshot**: XSS alert with URL visible

**Code Location**:
```php
echo $_GET['id']; // Direct output without sanitization
```

**Impact**: Phishing attacks, credential harvesting, malware distribution

---

### 4. IDOR (Insecure Direct Object Reference)

**File**: `profile.php` (Lines 30-32)

**Test Steps**:
- [ ] Register a new user account (User A)
- [ ] Note your user ID (e.g., ID = 5)
- [ ] View your profile: `profile.php?id=5`
- [ ] Change URL to: `profile.php?id=1` (admin's profile)
- [ ] **Expected**: Can view admin's profile including plain text password
- [ ] Try accessing: `profile.php?id=2`, `profile.php?id=3`, etc.
- [ ] **Screenshot**: Viewing another user's sensitive data

**Code Location**:
```php
$query = "SELECT * FROM users WHERE id = $requested_id";
// No ownership check!
```

**Impact**: Unauthorized data access, privacy breach, data theft

---

### 5. Broken Access Control (Admin Panel)

**File**: `admin.php` (Lines 17-19)

**Test Steps**:
- [ ] Register as a regular user (role will be 'user')
- [ ] Login with your new account
- [ ] Navigate to: `admin.php`
- [ ] **Expected**: Access granted despite not being admin
- [ ] View all users and their plain text passwords
- [ ] Test delete functionality: `admin.php?delete=4`
- [ ] **Screenshot**: Non-admin user accessing admin panel

**Code Location**:
```php
if (!isset($_SESSION['user_id'])) {
    header("Location: login.php");
    exit();
}
// MISSING: Role check!
```

**Impact**: Privilege escalation, unauthorized administrative actions, data deletion

---

### 6. Information Leakage

**File**: `db.php` (Lines 10-11)

**Test Steps**:
- [ ] In `db.php`, temporarily change database name to wrong value
- [ ] Try accessing any page
- [ ] **Expected**: Raw MySQL error with connection details displayed
- [ ] Try SQL injection with syntax error: `' OR 1=1 --'`
- [ ] **Expected**: Full SQL query visible in error message
- [ ] **Screenshot**: Error messages with sensitive info

**Code Location**:
```php
error_reporting(E_ALL);
ini_set('display_errors', 1);
```

**Impact**: Database structure exposure, easier exploitation, system info leak

---

### 7. No Password Hashing

**Files**: `register.php` (Line 21), Database

**Test Steps**:
- [ ] Register a new user with password: `MySecretPass123`
- [ ] Login as any user and visit `admin.php`
- [ ] Locate your new user in the table
- [ ] **Expected**: Password visible in plain text: `MySecretPass123`
- [ ] Open phpMyAdmin, browse `users` table
- [ ] **Screenshot**: Plain text passwords in database

**Code Location** (register.php):
```php
INSERT INTO users (username, email, password, role) 
VALUES ('$username', '$email', '$password', '$role')
```

**Impact**: Complete credential compromise if database is breached

---

### 8. No Session Timeout

**All authenticated pages**

**Test Steps**:
- [ ] Login to the application
- [ ] Note current time
- [ ] Leave browser open for 30+ minutes
- [ ] Navigate to `dashboard.php`
- [ ] **Expected**: Still logged in (no timeout)
- [ ] Close browser completely
- [ ] Reopen browser after 1 hour
- [ ] Navigate to `dashboard.php`
- [ ] **Expected**: Still logged in
- [ ] **Screenshot**: Session persisting after long period

**Missing Code**:
```php
// Should have timeout logic like:
if (time() - $_SESSION['last_activity'] > 1800) {
    session_destroy();
}
```

**Impact**: Session hijacking, unauthorized access on shared/public computers

---

### 9. CSRF (Cross-Site Request Forgery)

**File**: `admin.php` (Line 32)

**Test Steps**:
- [ ] Login as any user
- [ ] Create HTML file with: `<img src="http://localhost/insecure_blog/admin.php?delete=2">`
- [ ] Open the HTML file
- [ ] **Expected**: User with ID 2 gets deleted
- [ ] No CSRF token required
- [ ] **Screenshot**: User deleted via GET request

**Code Location**:
```php
$delete_query = "DELETE FROM users WHERE id = $delete_id";
// No CSRF token validation
```

**Impact**: Unauthorized actions performed on behalf of authenticated users

---

### 10. SQL Injection in Other Parameters

**Files**: Multiple pages

**Test Steps**:
- [ ] Try: `view_post.php?id=1 OR 1=1`
- [ ] Try: `profile.php?id=1 UNION SELECT 1,2,3,4,5`
- [ ] Try: `admin.php?delete=1 OR 1=1`
- [ ] **Expected**: SQL errors or unexpected behavior
- [ ] **Screenshot**: SQL injection in GET parameters

**Impact**: Data extraction, data modification, authentication bypass

---

## üìä Summary Report Template

After testing, document:

### Vulnerabilities Found

| # | Vulnerability | Severity | File | Status |
|---|--------------|----------|------|--------|
| 1 | SQL Injection | Critical | login.php | ‚úÖ Verified |
| 2 | Stored XSS | Critical | view_post.php | ‚úÖ Verified |
| 3 | Reflected XSS | High | profile.php | ‚úÖ Verified |
| 4 | IDOR | High | profile.php | ‚úÖ Verified |
| 5 | Broken Access Control | Critical | admin.php | ‚úÖ Verified |
| 6 | Information Leakage | Medium | db.php | ‚úÖ Verified |
| 7 | No Password Hashing | Critical | register.php | ‚úÖ Verified |
| 8 | No Session Timeout | Medium | All pages | ‚úÖ Verified |
| 9 | CSRF | High | admin.php | ‚úÖ Verified |

---

## üõ°Ô∏è Remediation Priority

1. **Critical** (Fix Immediately):
   - SQL Injection ‚Üí Use prepared statements
   - No Password Hashing ‚Üí Implement bcrypt/argon2
   - Broken Access Control ‚Üí Add role verification
   - Stored XSS ‚Üí Sanitize input, escape output

2. **High** (Fix Soon):
   - Reflected XSS ‚Üí Input validation, output escaping
   - IDOR ‚Üí Authorization checks
   - CSRF ‚Üí CSRF tokens

3. **Medium** (Fix When Possible):
   - Information Leakage ‚Üí Disable error display
   - Session Timeout ‚Üí Implement timeout logic

---

## üì∏ Documentation Tips

For each vulnerability:
1. Screenshot of the vulnerable code
2. Screenshot of successful exploit
3. Screenshot of the impact
4. Code snippet showing the fix

---

## ‚ö†Ô∏è Testing Safety

- ‚úÖ Test only on localhost
- ‚úÖ Never expose to internet
- ‚úÖ Use isolated environment
- ‚úÖ Delete after learning
- ‚ùå Never test on production systems
- ‚ùå Never use real user data

---

**Testing Date**: ______________
**Tester Name**: ______________
**Lab Section**: ______________
**Completion**: _____ / 10 vulnerabilities verified

---

Good luck with your security testing! üîí
